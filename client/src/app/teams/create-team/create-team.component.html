<div class="form-wrapper">
    <section [ngClass]="expanded?'form-filter active' : 'form-filter hide'">
        <h5>List of teams</h5>
        
        <i class="pi pi-angle-double-left" (click)="onFilter($event)" style="color: gray"></i>
        <div style="margin-top: 5rem;">
            <p-table [value]="teams" selectionMode="single" dataKey="code">
                <ng-template pTemplate="caption">
                    <div class="flex">
                        <a routerLink="./create-team">
                            <i class="pi pi-plus" style="color: green;font-size: 1rem"></i>
                            <span class="ml-2 font-bold">Create</span>
                        </a>

                        <span class=" p-input-icon-left ml-auto">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" placeholder="Search keyword" />
                        </span>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th>Name</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-team>
                    <tr [pSelectableRow]="team" (mouseover)="op.show($event)" (mouseleave)="op.hide()">
                        <td>{{team.teamName}}</td>
                    </tr>
                    <p-overlayPanel [showTransitionOptions]="'0.40s cubic-bezier(1,1,1,1)'"
                        [hideTransitionOptions]="'.1s ease-in'" #op>
                        <img src="https://primefaces.org/cdn/primeng/images/demo/product/bamboo-watch.jpg"
                            alt="product" />
                    </p-overlayPanel>
                </ng-template>
            </p-table>
        </div>
    </section>
    <section [ngClass]="expanded?'filter-expander hide' : 'filter-expander active'">
        <i class="pi pi-angle-double-right" (click)="onFilter($event)" style="color: gray"></i>
    </section>
    <form [formGroup]="teamForm" (ngSubmit)="onSubmit()">
    <section [ngClass]="expanded?'form-content' : 'form-content full'">
            <h3>Create Team</h3>
            <p-messages [(value)]="messages!" [enableService]="false" [closable]="true"></p-messages>
            
            <div class="grid p-fluid formgrid md:ml-2 field-scrollable">
                
                <div class="field col-12 xs:col-12 sm:col-12 md:col-6 md:mb-0 lg:col-10 lg:mb-0">
                    <p>The form represents a team management interface. It includes a collapsible section for displaying a list of teams, a section for creating new teams, and a form action section with a "Save" button. Users can toggle the visibility of the team list and add team details such as team name, department, manager, team leader, and members.</p>    
                <div class="field-flex">
                    <div class="col-12 xs:col-4 sm:col-4 md:col-4 lg:col-3">
                        <label class="required" for="username1">Team Name</label>
                    </div>

                    <div class="col-12 xs:col-10 sm:col-10 md:col-8 lg:col-6">
                        <input id="username1"  formControlName="teamName" pInputText  class="custom-input "/>
                    </div>
                    <div class="col-12 xs:col-2 sm:col-2 md:col-2 lg:col-1">
                        <ng-container *ngIf="f.teamName.errors && f.teamName.touched">
                            <p-message severity="error"></p-message>
                        </ng-container>
                    </div>
                    
                </div>

                <div class="field-flex">
                    <div class="col-12 md:col-4 lg:col-3">
                        <label class="required" for="username1">Department</label>
                    </div>

                    <div class="col-12 md:col-6 lg:col-6">
                        <app-department-ddl formControlName="departmentId"></app-department-ddl>

                    </div>

                </div>
                <div class="field-flex">
                    <div class="col-12 md:col-4 lg:col-3">
                        <label class="required" for="username1">Team Manager</label>
                    </div>

                    <div class="col-12 md:col-6 lg:col-6">
                        <p-dropdown [options]="manger" [filter]="true" filterBy="displayName" [showClear]="true"
                            placeholder="Select Manager" styleClass="showAbove" appendTo="body"
                             optionLabel="displayName" (onChange)="addManager($event)">
                            <ng-template pTemplate="selectedItem" let-item>
                                <div class="country-item">
                                    <div>{{item.displayName}}</div>
                                </div>
                            </ng-template>
                            <ng-template let-division pTemplate="item">
                                <div class="country-item">
                                    <div>{{division.displayName}}</div>
                                </div>
                            </ng-template>
                        </p-dropdown>

                    </div>

                </div>
                <div class="field-flex">
                    <div class="col-12 md:col-4 lg:col-3">
                        <label class="required" for="username1">Team Leader</label>
                    </div>

                    <div class="col-12 md:col-6 lg:col-6">
                        <p-dropdown [options]="teamLeader" [filter]="true" filterBy="displayName" [showClear]="true"
                            placeholder="Select Teamleader" styleClass="showAbove" appendTo="body"
                            optionLabel="displayName"
                            (onChange)="addTeamLeader($event)">
                            <ng-template pTemplate="selectedItem" let-item>
                                <div class="country-item">
                                    <div>{{item.displayName}}</div>
                                </div>
                            </ng-template>
                            <ng-template let-division pTemplate="item">
                                <div class="country-item">
                                    <div>{{division.displayName}}</div>
                                </div>
                            </ng-template>
                        </p-dropdown>

                    </div>

                </div>
                <div class="field-flex">
                    <div class="col-12 md:col-4 lg:col-3">
                        <label  for="username1">Team Members</label>
                    </div>

                    <div class="col-12 md:col-6 lg:col-6">
                        <p-table [value]="members"  [scrollable]="true" scrollHeight="400px"
                            [tableStyle]="{ 'min-width': '100rem' }" selectionMode="multiple"
                            [(selection)]="selectedEmployees" styleClass="p-datatable-sm "
                            (onRowSelect)="addMember($event)" (onRowUnselect)="addMember($event)">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>Name</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-emp>
                                <tr [pSelectableRow]="emp">
                                    <td>{{ emp.displayName }}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="5">No employees found.</td>
                                </tr>
                            </ng-template>
                            
                        </p-table>

                    </div>

                </div>
                <div class="field-flex">
                    <div class="col-12 md:col-4 lg:col-3">
                        <label class="required" for="username1">Selected Members</label>
                    </div>
                    <div class="col-12 md:col-6 lg:col-6">
                        <p-listbox [options]="teamDetail" formControlName="teamDetails" [readonly]="true" optionLabel="employeeId" 
                        [style]="{'width':'25rem','height':'200px'}"></p-listbox>
                    </div>
                </div>
                </div>
            </div>
            
    </section>
    <section  [ngClass]="expanded?'form-action' : 'form-action full'">
        <hr>
        <button pButton pRipple type="submit" label="Save"></button>
    </section>
</form>
</div>